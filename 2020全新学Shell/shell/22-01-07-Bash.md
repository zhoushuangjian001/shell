# Bash 22-01-07

## 1. 函数定义

- 可以使用 `function func()`, 也可以直接`fun()` 定义，不带任何参数。

  ```shell
  # 方法一
  function name {
      commands
      [return value]
  }

  # 方法二
  name() {
      commands
      [return value]
  }
  ```

## 2. 循环结构

- for 语句

  ```shell
  for 变量 in 值集合
  do
    commands
  done
  ```

  实例:

  ```shell
  #!/usr/bin/env bash
  for i in {1..10}
  do
    mkdir -p /datas/demo$i
  done
  ```

- while 循环

  首先判断条件，在执行代码。

  ```shell
  while 条件
  do
      commid
  done
  ```

- until 循环
  until 循环是当条件为假的时候，才进入循环。
  ```shell
  until 条件
  do
      commands
  done
  ```

## 3. 循环控制

- 循环控制说明
  |命令|说明|
  |-|-|
  | break n | n 表示跳出循环的次数，如果省略 n 表示跳出整个循环 |
  | continue n |n 表示退到第 n 层循环，如果省略 n ，则表示跳出本次循环进入下一次循环。 |
  | exit n | 退出当前 Shell 循环，并返回 n, n 也可以省略 |
  |return | 用于返回一个退出值给调用的函数|

## 4. 条件测试语法

- 基础测试方法
  |test 测试表达式|test 命令与测试表达式之间至少一个空格|
  |-|-|
  |[ 测试表达式 ]|[] 中括号边界与测试表达式之间至少有一个空格|
  |[[测试表达式]]|[[]] 中括号边界与测试表达式之间至少有一个空格|
  |((条件表达式))|(()) 双小括号，得小括号不需要空格|

## 5. 测试表达式用法

1. 文件测试表达式
   |-d 文件| 文件存在且为目录为真|
   |-|-|
   |-f 文件| 文件存在且为普通文件|
   |-e 文件| 文件存在则为真，不辨别目录还是文件|
   |-s 文件| 文件存在且文件大小不为 0，则为真|
   |-r 文件| 文件存在且可读，则为真|
   |-w 文件| 文件存在且可写，则为真|
   |-x 文件| 文件存在且可执行，则为真|
   |-L 文件| 文件存在且为链接文件，则为真|
   |f1 -nt f2| 文件 f1 比文件 f2 新则为真，根据文件的修改时间计算|
   |f1 -ot f2| 文件 f1 比文件 f2 旧，则为真。根据文件的修改时间计算的|

2. 字符串测试表达式
   |表达式|功能|
   |-|-|
   |-z s1 | 如果 s1 的长度为 0，则测试条件为真|
   |-n s1 | 如果字符串的长度大于 0，则测试条件为真|
   |sl | 如果 s1 不是空字符串，则测试条件为真|
   |s1 = s2 或者 s1 == s2 | 如果 s1 等与 s2 ，则测试条件为真，等号两边都要有空格|
   |s1 != s2 | 如果 s1 不等于 s2 ,则测试条件为真|

3. 整数操作符
   |在 [] 和 test 中使用|在 [[]] 和 (()) 中使用| 说明|
   |-|-|-|
   | -eq | == 或 = | 等于 |
   | -nq | != | 不等于 |
   | -gt | > | 大于 |
   | -ge | >= | 大于等于 |
   | -lt | < | 小于 |
   | -le | <= | 小于等于 |

   注意：在正则时，必须使用 [[]]。

## 6. 分支语句

1. if 单分支语句

   ```shell
   # 格式
    if [ 条件判断试 ];then
        commands
    fi
   ```

2. if 双分支语句

   ```shell
    if [ 条件判断式 ];then
        commands1
    else
        commands2
    fi
   ```

3. if 多分支语句

   ```shell
    if [ 条件判断式1 ];then
        commands1
    elif [ 条件判断式2 ];then
        commands2
    else
        commands3
    fi
   ```
